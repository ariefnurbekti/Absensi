<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Board - AbsensiApp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <style>
        /* Custom styles for Kanban board */
        .kanban-board {
            display: flex;
            gap: 1.5rem; /* Space between columns */
            overflow-x: auto; /* Allow horizontal scrolling */
            padding-bottom: 1rem;
            min-height: 80vh;
        }
        .kanban-column {
            flex: 0 0 320px; /* Fixed width for columns, prevent shrinking */
            display: flex;
            flex-direction: column;
            background-color: #f4f5f7; /* Trello-like column color */
            border-radius: 0.75rem;
            max-height: 80vh;
        }
        .kanban-cards {
            flex-grow: 1;
            overflow-y: auto; /* Allow vertical scrolling for cards */
            padding: 0 0.75rem;
        }
        .kanban-card {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: grab;
            transition: background-color 0.2s;
        }
        .kanban-card:hover {
            background-color: #f9fafb; /* Slightly grey on hover */
        }
        /* For drag-and-drop placeholder */
        .sortable-ghost {
            background-color: #e0e7ff;
            border: 2px dashed #6366f1;
        }
    </style>
</head>
<body class="h-full flex">

    <!-- Sidebar (Re-using the existing structure) -->
    <aside class="w-64 flex flex-col bg-white border-r border-slate-200">
        <div class="p-6 text-center border-b border-slate-200">
            <h1 class="text-2xl font-bold text-sky-600">AbsensiApp</h1>
        </div>
        <div id="user-profile" class="p-6 flex flex-col items-center border-b border-slate-200">
            <img id="user-pic" src="" class="w-20 h-20 rounded-full object-cover mb-2 shadow-md">
            <span id="user-name" class="font-semibold text-slate-700">Loading...</span>
        </div>
        <nav class="flex-1 p-4 space-y-2">
            <a href="/dashboard.html" class="w-full flex items-center px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors">
                <i class="fas fa-tachometer-alt w-6 mr-3 text-slate-400"></i>
                Dashboard
            </a>
            <a href="/planner.html" class="w-full flex items-center px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors">
                <i class="fas fa-calendar-check w-6 mr-3 text-slate-400"></i>
                Planner
            </a>
            <a href="/manage-project.html" class="w-full flex items-center px-4 py-2 text-slate-700 bg-sky-100 rounded-lg font-semibold border-l-4 border-sky-500">
                <i class="fas fa-briefcase w-6 mr-3 text-sky-500"></i>
                Manage Project
            </a>
        </nav>
        <div class="p-4 border-t border-slate-200">
            <a href="/logout" class="w-full flex items-center px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors">
                <i class="fas fa-sign-out-alt w-6 mr-3 text-slate-400"></i>
                Logout
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6 flex flex-col">
        <header class="mb-6">
            <h1 class="text-3xl font-bold text-slate-800">Project Alpha</h1>
            <p class="text-slate-500">A Kanban board to track progress.</p>
        </header>
        
        <!-- Kanban Board -->
        <div id="kanban-board" class="kanban-board">

            <!-- Column 1: Backlog -->
            <div class="kanban-column" data-column-id="backlog">
                <header class="p-4 font-semibold text-lg text-slate-700 border-b border-slate-200 flex justify-between items-center">
                    <span>Backlog</span>
                    <span class="text-sm text-slate-500 bg-slate-200 px-2 rounded-full">3</span>
                </header>
                <div class="kanban-cards p-2">
                    <!-- Example Cards -->
                    <div class="kanban-card" data-task-id="1">Design the login page</div>
                    <div class="kanban-card" data-task-id="2">Set up the database schema</div>
                    <div class="kanban-card" data-task-id="3">Implement user authentication</div>
                </div>
                <footer class="p-2">
                    <button class="w-full text-left p-2 text-slate-500 hover:bg-slate-200 rounded-lg">+ Add a card</button>
                </footer>
            </div>

            <!-- Column 2: In Progress -->
            <div class="kanban-column" data-column-id="in-progress">
                <header class="p-4 font-semibold text-lg text-slate-700 border-b border-slate-200 flex justify-between items-center">
                    <span>In Progress</span>
                    <span class="text-sm text-slate-500 bg-slate-200 px-2 rounded-full">1</span>
                </header>
                <div class="kanban-cards p-2">
                    <div class="kanban-card" data-task-id="4">Develop the main dashboard UI</div>
                </div>
                <footer class="p-2">
                    <button class="w-full text-left p-2 text-slate-500 hover:bg-slate-200 rounded-lg">+ Add a card</button>
                </footer>
            </div>

            <!-- Column 3: Done -->
            <div class="kanban-column" data-column-id="done">
                <header class="p-4 font-semibold text-lg text-slate-700 border-b border-slate-200 flex justify-between items-center">
                    <span>Done</span>
                    <span class="text-sm text-slate-500 bg-slate-200 px-2 rounded-full">2</span>
                </header>
                <div class="kanban-cards p-2">
                     <div class="kanban-card line-through text-slate-500" data-task-id="5">Initial project setup</div>
                     <div class="kanban-card line-through text-slate-500" data-task-id="6">Configure Tailwind CSS</div>
                </div>
                <footer class="p-2">
                    <button class="w-full text-left p-2 text-slate-500 hover:bg-slate-200 rounded-lg">+ Add a card</button>
                </footer>
            </div>

        </div>
    </main>

    <!-- CDN for SortableJS for drag-and-drop functionality -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>

    <script src="/js/board.js"></script>
    <script>
        // User data fetcher for sidebar (as before)
        async function fetchUserData() {
            try {
                const response = await fetch('/api/user');
                if (!response.ok) { window.location.href = '/login.html'; return; }
                const user = await response.json();
                document.getElementById('user-pic').src = user.picture;
                document.getElementById('user-name').textContent = user.name;
            } catch (error) {
                console.error('Error fetching user data:', error);
                window.location.href = '/login.html';
            }
        }
        document.addEventListener('DOMContentLoaded', fetchUserData);
    </script>
</body>
</html>
